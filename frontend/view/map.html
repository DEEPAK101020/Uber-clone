<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBl63QTmfYk3TROXtYhlDbB4KZ_lPe6EZE&libraries=places&callback=initMap"></script>
    
   <style>
    #map {
      height: 700px;
      width: 70%;
    }
  </style>
  </head>
  <body>
    <div>
      <label for="startLocation">Start Location:</label>
      <input type="text" id="startLocation" class="location-input" />
    </div>

    <div>
      <label for="destinationLocation">Destination Location:</label>
      <input type="text" id="destinationLocation" class="location-input" />
    </div>

    <div id="map"></div>
    <input type="text" id="pac-input" placeholder="Search places" />

    <script>
      function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 20.5937, lng: 78.9629 }, // Approximate center of India
            zoom: 5,
        });

        const startInput = document.getElementById("startLocation");
        const destinationInput = document.getElementById("destinationLocation");

        const startSearchBox = new google.maps.places.SearchBox(startInput);
        const destinationSearchBox = new google.maps.places.SearchBox(
          destinationInput
        );

        map.controls[google.maps.ControlPosition.TOP_LEFT].push(startInput);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(
          destinationInput
        );

        map.addListener("bounds_changed", function () {
          startSearchBox.setBounds(map.getBounds());
          destinationSearchBox.setBounds(map.getBounds());
        });

        let startMarker;
        let destinationMarker;
        let directionsService = new google.maps.DirectionsService();
        let directionsRenderer = new google.maps.DirectionsRenderer({
          map: map,
        });

        startSearchBox.addListener("places_changed", function () {
          const places = startSearchBox.getPlaces();
          if (places.length === 0) return;

          if (startMarker) {
            startMarker.setMap(null);
          }

          startMarker = new google.maps.Marker({
            map: map,
            title: places[0].name,
            position: places[0].geometry.location,
          });

          calculateAndDisplayRoute();
        });

        destinationSearchBox.addListener("places_changed", function () {
          const places = destinationSearchBox.getPlaces();
          if (places.length === 0) return;

          if (destinationMarker) {
            destinationMarker.setMap(null);
          }

          destinationMarker = new google.maps.Marker({
            map: map,
            title: places[0].name,
            position: places[0].geometry.location,
          });

          calculateAndDisplayRoute();
        });

        function calculateAndDisplayRoute() {
          if (startMarker && destinationMarker) {
            const request = {
              origin: startMarker.getPosition(),
              destination: destinationMarker.getPosition(),
              travelMode: "DRIVING",
            };

            directionsService.route(request, function (result, status) {
              if (status === "OK") {
                directionsRenderer.setDirections(result);
              }
            });
          }
        }
      }

      initMap();
    </script>

    
  </body>
</html>
